{"visual":{"name":"Statistics_Tests","displayName":"Statistics Tests","guid":"PBI_CV_5503E017_0853_4327_9C12_DEE73CE835B7","visualClassName":"Visual","version":"1.0.0","description":"","supportUrl":"","gitHubUrl":""},"apiVersion":"1.4.0","author":{"name":"Alaeddin Badran","email":"alaeddin14@windowslive.com"},"assets":{"icon":"assets/icon.png"},"externalJS":[],"style":"style/visual.less","capabilities":{"dataRoles":[{"displayName":"Values","description":"Numeric or categorical variables. At least 2 rows. At least 2 columns.","kind":"GroupingOrMeasure","name":"Values"}],"dataViewMappings":[{"conditions":[{"Values":{"max":1000}}],"scriptResult":{"dataInput":{"table":{"rows":{"for":{"in":"Values"},"dataReductionAlgorithm":{"top":{}}}}},"script":{"scriptProviderDefault":"R","scriptOutputType":"png","source":{"objectName":"rcv_script","propertyName":"source"},"provider":{"objectName":"rcv_script","propertyName":"provider"},"scriptSourceDefault":"###############Library Declarations###############\r\n\r\nlibraryRequireInstall = function(packageName, ...) {\r\n    if (!require(packageName, character.only = TRUE))\r\n        warning(paste(\"*** The package: '\", packageName, \"' was not installed ***\", sep = \"\"))\r\n    }\r\n\r\n#libraryRequireInstall(\"gridExtra\")\r\nsuppressWarnings(libraryRequireInstall(\"ggplot2\"))\r\nsuppressWarnings(libraryRequireInstall(\"grid\"))\r\n#libraryRequireInstall(\"MASS\")\r\nsuppressWarnings(libraryRequireInstall(\"gridExtra\"))\r\nsuppressWarnings(libraryRequireInstall(\"gridBase\"))\r\n\r\n\r\n\r\n#options(warn = -1)\r\n#t_dataset <- as.data.frame(iris[, 1:3])\r\n#chi_dataset <- as.data.frame(survey[, c(\"Smoke\", \"Exer\", \"Sex\")])\r\n\r\n############ User Parameters #########\r\n\r\nif (exists(\"settings_stats_tests_params_show\") && settings_stats_tests_params_show == FALSE)\r\n    rm(list = ls(pattern = \"settings_stats_tests_params_\"))\r\nif (exists(\"settings_labels_params_show\") && settings_labels_params_show == FALSE)\r\n    rm(list = ls(pattern = \"settings_labels_params_\"))\r\n\r\n\r\nif (!exists(\"dataset\") && exists(\"Values\"))\r\n    dataset = Values\r\n\r\n\r\ntl.col = \"blue\"\r\nif (exists(\"settings_labels_params_tl_col\"))\r\n    tl.col = settings_labels_params_tl_col\r\n\r\n\r\n\r\nmethod = NULL\r\nif (exists(\"settings_stats_tests_params_statistics_test\"))\r\n    method = settings_stats_tests_params_statistics_test\r\n\r\nConfidence = \"95%\"\r\nif (exists(\"settings_stats_tests_params_Confidence_Level\"))\r\n    Confidence = settings_stats_tests_params_Confidence_Level\r\n\r\nif (Confidence == \"95%\") {\r\n    significance_level <- 0.05\r\n} else if (Confidence == \"90%\") {\r\n    significance_level <- 0.1\r\n} else if (Confidence == \"99%\") {\r\n    significance_level <- 0.01\r\n}\r\n\r\n\r\n\r\nif (!exists(\"dataset\")) {\r\n    #require(\"datasets\")\r\n    dataset = as.data.frame(iris[, 1:3]) #mpg,cyl,disp,hp,drat,wt,qsec,vs,am,gear,carb\r\n}\r\n\r\n\r\n#Testing:\r\n#dataset <- chi_dataset #t_dataset  #chi_dataset\r\n#method <- \"chi_square\" #\"t_test\"  #\"chi_square\"\r\n\r\n#Outcome: \r\n\r\nif (is.null(method)) {\r\n    outcome <- \"Please select the statiscical test\" #\"Please select at least 2 variables\"\r\n    Warning_msg <- \"\"\r\n} else if (method == \"t_test\") {\r\n    if (!exists(\"dataset\") | dim(dataset)[2] < 2) {\r\n        outcome = \"Please select 2 variables\"\r\n    } else {\r\n        summary_t_test1 <- summary(dataset[, 1:2])\r\n        summary_t_test <- rbind(colnames(summary_t_test1), summary_t_test1)\r\n        stat_test <- t.test(dataset[, 1:2])\r\n        options(digits = 3)\r\n        T <- data.frame(format(round(stat_test$statistic, 2), nsmall = 2), row.names = NULL)\r\n        P <- data.frame(format(round(stat_test$p.value, 5), nsmall = 5), row.names = NULL)\r\n        Comment <- ifelse(stat_test$p.value >= significance_level, \"The averages of the 2 variables are significantly similar\", \"The averages of the 2 variables are significantly different\")\r\n        outcome <- data.frame(cbind(T, P, Comment))\r\n        rownames(outcome) <- \" \"\r\n        colnames(outcome) <- c(\"t-test value\", \"p-value\", \"Comment\")\r\n        Warning_msg <- if (dim(dataset)[2] > 2) {\r\n            paste(\"Only the following 2 variables were used: \", colnames(dataset[1]), \"and\", colnames(dataset[2]), sep = \" \")\r\n        } else { \"\" }\r\n        }\r\n\r\n} else if (method == \"chi_square\") {\r\n    if (!exists(\"dataset\") | dim(dataset)[2] < 2) {\r\n        outcome = \"Please select 2 variables\"\r\n    } else {\r\n        chi_table <- table(factor(dataset[, 1]), factor(dataset[, 2]))\r\n        chi_test <- chisq.test(chi_table)\r\n        #options(digits = 2)\r\n        chi_score <- chi_test$statistic\r\n        chi_pv <- chi_test$p.value\r\n        Comment <- ifelse(chi_test$p.value >= significance_level,\r\n            paste(\"There is no relationship between\", names(dataset)[1], \"and\", names(dataset)[2], sep = \" \"),\r\n            paste(\"There is a relationship between\", names(dataset)[1], \"and\", names(dataset)[2], sep = \" \")\r\n        )\r\n        #options(digits = 2)\r\n        outcome <- data.frame(cbind(format(round(chi_score, 3), nsmall = 2), format(round(chi_pv, 3), nsmall = 2), Comment))\r\n        colnames(outcome) <- c(\"Chi-Square value\", \"p-value\", \"Comment\")\r\n        Warning_msg <- if (dim(dataset)[2] > 2) {\r\n            paste(\"Only the following 2 variables were used: \", colnames(dataset[1]), \"and\", colnames(dataset[2]), sep = \" \")\r\n        } else { paste(\"\") }\r\n        }\r\n}\r\n\r\n\r\n\r\n#Plots themes\r\ntheme_def <- ttheme_default()\r\ntheme_min <- ttheme_minimal()\r\ntheme_blue <- ttheme_minimal(\r\n  core = list(bg_params = list(fill = blues9[c(6,2,2,2,2,2,2,2,2)], col = NA),\r\n            fg_params = list(fontface = 3)),\r\n  colhead = list(fg_params = list(col = tl.col, fontface = 4L)),\r\n  rowhead = list(fg_params = list(col = tl.col, fontface = 3L)))\r\ntheme_blue2 <- ttheme_minimal(\r\n  core = list(bg_params = list(fill = blues9[c(2, 2, 2, 2, 2, 2, 2, 2, 2)], col = NA),\r\n            fg_params = list(fontface = 3)),\r\n  colhead = list(fg_params = list(col = tl.col, fontface = 4L)),\r\n  rowhead = list(fg_params = list(col = tl.col, fontface = 3L)))\r\nn_rows <- if (Warning_msg == \"\") { 2 } else { 3 }\r\n\r\n\r\n\r\n#Plots\r\n\r\nif (is.null(method)) {\r\n    n_rows <- 1\r\n    grid.arrange(\r\n  tableGrob(outcome, theme = theme_blue),\r\n  nrow = 3)\r\n} else if (method == \"t_test\") {\r\n    grid.arrange(\r\n    tableGrob(summary_t_test, theme = theme_blue, cols = colnames(dataset[, 1:2])),\r\n    tableGrob(outcome, theme = theme_def),\r\n    tableGrob(Warning_msg, theme = theme_min),\r\n    nrow = 3,\r\n    ncol = 1\r\n    )\r\n} else if (method == \"chi_square\") {\r\n    grid.arrange(\r\n        tableGrob(chi_table, theme = theme_blue2),\r\n        tableGrob(outcome, theme = theme_def),\r\n        tableGrob(Warning_msg,theme=theme_min),\r\n    nrow = 3,\r\n    ncol = 1\r\n        )\r\n}\r\n\r\n\r\n"}}}],"objects":{"rcv_script":{"properties":{"provider":{"type":{"text":true}},"source":{"type":{"scripting":{"source":true}}}}},"settings_stats_tests_params":{"displayName":"Statistics Tests Parameters","properties":{"show":{"type":{"bool":true}},"Confidence_Level":{"displayName":" Confidence Level","description":"The confidence level of the statistics test","type":{"enumeration":[{"displayName":"90%","value":"90%"},{"displayName":"95%","value":"95%"},{"displayName":"99%","value":"99%"}]}},"statistics_test":{"displayName":" Statistics Test","description":"Please select the statistics test you want to perform","type":{"enumeration":[{"displayName":"t_test","value":"t_test"},{"displayName":"chi_square","value":"chi_square"}]}}}},"settings_labels_params":{"displayName":"Labels","description":"Control the appearance of labels","properties":{"show":{"type":{"bool":true}},"tl_col":{"displayName":"Color","type":{"fill":{"solid":{"color":true}}}}}}},"suppressDefaultTitle":true},"dependencies":{"cranPackages":[{"name":"ggplot2","displayName":"GG Plot 2","url":"https://cran.r-project.org/web/packages/ggplot2/index.html"},{"name":"grid","displayName":"Grid","url":"https://cran.r-project.org/web/packages/grid/index.html"},{"name":"gridExtra","displayName":"GridExtra","url":"https://cran.r-project.org/web/packages/gridExtra/index.html"},{"name":"gridBase","displayName":"gridBase","url":"https://cran.r-project.org/web/packages/gridBase/index.html"}]},"content":{"js":"var powerbi;!function(t){var s;!function(t){var s;!function(t){var s;!function(t){function s(t,s,e,i){if(t){var a=t[s];if(a){var n=a[e];if(void 0!==n)return n}}return i}function e(t,s,e,i,a,n){if(t){var r=t[s];if(r){var _=r[e];if(_<a)return a;if(_>n)return n;if(void 0!==_)return _}}return i}function i(t,s,e,i,a,n){if(t){var r=t[s];if(r){var _=r[e];if(void 0!==_)return _>n?n:_<a?a:_}}return i}function a(t,s,e,i,a,n){return n&&s==e&&1==a?i:n&&s!=e&&0==a?i:t}function n(t,s,e){return t<s?s:t>e?e:t}function r(t,s,e,i,a){var n=t.objects;if(n){var r=n[s];if(r){var _=r[e];if(_){var o=_[i];if(void 0!==o)return o}}}return a}t.getValue=s,t.getValueMinMax=e,t.getValueNumberMinMax=i,t.ifStringReturnString=a,t.inMinMax=n,t.getCategoricalObjectValue=r}(s=t.PBI_CV_5503E017_0853_4327_9C12_DEE73CE835B7||(t.PBI_CV_5503E017_0853_4327_9C12_DEE73CE835B7={}))}(s=t.visual||(t.visual={}))}(s=t.extensibility||(t.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(t){var s;!function(t){var s;!function(t){var s;!function(t){var s=function(){function s(t){this.imageDiv=document.createElement(\"div\"),this.imageDiv.className=\"rcv_autoScaleImageContainer\",t.element.appendChild(this.imageDiv),this.imageElement=document.createElement(\"img\"),this.imageElement.className=\"rcv_autoScaleImage\",this.imageDiv.appendChild(this.imageElement),this.settings_stats_tests_params={show:!1,statistics_test:\"t_test\",Confidence_Level:\"95%\"},this.settings_labels_params={show:!1,tl_col:\"red\"}}return s.prototype.update=function(s){var e=s.dataViews;if(e&&0!==e.length){var i=e[0];if(i&&i.metadata){this.settings_stats_tests_params={show:t.getValue(i.metadata.objects,\"settings_stats_tests_params\",\"show\",!1),statistics_test:t.getValue(i.metadata.objects,\"settings_stats_tests_params\",\"statistics_test\",\"t_test\"),Confidence_Level:t.getValue(i.metadata.objects,\"settings_stats_tests_params\",\"Confidence_Level\",\"95%\")},this.settings_labels_params={show:t.getValue(i.metadata.objects,\"settings_labels_params\",\"show\",!1),tl_col:t.getValue(i.metadata.objects,\"settings_labels_params\",\"tl_col\",\"red\")};var a=null;i.scriptResult&&i.scriptResult.payloadBase64&&(a=\"data:image/png;base64,\"+i.scriptResult.payloadBase64),a?this.imageElement.src=a:this.imageElement.src=null,this.onResizing(s.viewport)}}},s.prototype.onResizing=function(t){this.imageDiv.style.height=t.height+\"px\",this.imageDiv.style.width=t.width+\"px\"},s.prototype.enumerateObjectInstances=function(t){var s=t.objectName,e=[];switch(s){case\"settings_stats_tests_params\":\"t_test\"==this.settings_stats_tests_params.statistics_test?e.push({objectName:s,properties:{show:this.settings_stats_tests_params.show,statistics_test:this.settings_stats_tests_params.statistics_test,Confidence_Level:this.settings_stats_tests_params.Confidence_Level},selector:null}):e.push({objectName:s,properties:{show:this.settings_stats_tests_params.show,statistics_test:this.settings_stats_tests_params.statistics_test},selector:null});break;case\"settings_labels_params\":e.push({objectName:s,properties:{show:this.settings_labels_params.show,tl_col:this.settings_labels_params.tl_col},selector:null})}return e},s}();t.Visual=s}(s=t.PBI_CV_5503E017_0853_4327_9C12_DEE73CE835B7||(t.PBI_CV_5503E017_0853_4327_9C12_DEE73CE835B7={}))}(s=t.visual||(t.visual={}))}(s=t.extensibility||(t.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(t){var s;!function(s){var e;!function(s){s.PBI_CV_5503E017_0853_4327_9C12_DEE73CE835B7={name:\"PBI_CV_5503E017_0853_4327_9C12_DEE73CE835B7\",displayName:\"Statistics Tests\",class:\"Visual\",version:\"1.0.0\",apiVersion:\"1.4.0\",create:function(s){return new t.extensibility.visual.PBI_CV_5503E017_0853_4327_9C12_DEE73CE835B7.Visual(s)},custom:!0}}(e=s.plugins||(s.plugins={}))}(s=t.visuals||(t.visuals={}))}(powerbi||(powerbi={}));","css":".visual-PBI_CV_5503E017_0853_4327_9C12_DEE73CE835B7 .rcv_autoScaleImageContainer{position:relative}.visual-PBI_CV_5503E017_0853_4327_9C12_DEE73CE835B7 .rcv_autoScaleImageContainer .rcv_autoScaleImage{max-width:100%;max-height:100%;position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%);-webkit-transform:translateY(-50%) translateX(-50%)}","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABp0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjUuMTAw9HKhAAAB6ElEQVQ4T42Uyy8DURTG6xF/joSV0JZ4s7HxB9hYNGlLUmKBkAix8FiJEE1FupLYIEgEnSkJgkY86pV4xZsgDVVMj+80TaPTebX5cmfunPs735y595hMCj+HYElzCpZsqB2ahrbimsHYCeVwjNLalLk4aBGjBJGKophfgXJVoU7RbEJAPRTWAMkTRBBrt/usqW7xwKbjSsutK8kpQHkQZ0taNLzXRJOn/SkaDNjk8B+sLYpBHT5LBm42lF7zKnRMUfxfwvf0HL5NaO7CreR2F6xMrluxWs28R90x4Oz5qNrryuerGTik9REWr7wUjUrkOewwAnUzcFML2CgW0c7jEn1LX6RQO3mSAwbe6m0Tl7+UrlFPrmOjWKjl9I2Bd3rAjvVaCn2/UuBxmRoEqy6Qj5VqkMtfQufv+/TwcUkta1V6dQyywxEtoHgzRREpTL1bdXowfj7BwAo14ESwC5tGIu9RjxEYx9Twxs7ERUAObV4tp8+fEL1FnmjhcpzmLzwJjR20KiUIOgRzVuy08LGB+PgkAptWy+jkdTtWP7k4gczAL+4r5ee5GZPcloy+3v+4zpQ25kALAoyhSU51ErCzNqevQL3ZIiAf4mah55a3W6Ghro0PlY5gM9QHidBZXH6MAwyyo0spwf4AtHVNfxi+gekAAAAASUVORK5CYII="}}